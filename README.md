# Machine-Learning-final
# Poverty Rate Prediction from Household Survey Data

## Περιγραφή
Στόχος του project είναι η πρόβλεψη της ημερήσιας κατά κεφαλήν κατανάλωσης των νοικοκυριών και, κατ’ επέκταση, η εκτίμηση των poverty rates, με χρήση δεδομένων ερευνών νοικοκυριών και διαφορετικών μοντέλων μηχανικής μάθησης.

---

## Δεδομένα
Τα αρχεία:
- `train_hh_gt.csv`
- `train_hh_features.csv`

περιέχουν συμπληρωματικές πληροφορίες που είναι απαραίτητες για το training dataset.  
Η ένωση των δύο αρχείων πραγματοποιείται με βάση:
- το **household ID**
- το **survey ID**

ώστε κάθε εγγραφή να αντιστοιχεί σε ένα συγκεκριμένο νοικοκυριό και έρευνα.

---

## Προεπεξεργασία Δεδομένων
Πριν την εκπαίδευση των μοντέλων εφαρμόζονται τα παρακάτω βήματα:
- Συμπλήρωση κενών τιμών
- Scaling των αριθμητικών χαρακτηριστικών
- One-hot encoding των κατηγορικών μεταβλητών

Η ίδια ακριβώς διαδικασία προεπεξεργασίας εφαρμόζεται σε όλα τα μοντέλα.

---

## Μεθοδολογία Αξιολόγησης
Η αξιολόγηση πραγματοποιείται με **GroupKFold**, με ομαδοποίηση βάσει του `survey_id`.  
Με αυτόν τον τρόπο εξασφαλίζεται ότι κάθε survey εμφανίζεται αποκλειστικά είτε στο training είτε στο validation set, προσομοιώνοντας τη γενίκευση του μοντέλου σε δεδομένα διαφορετικών ετών συλλογής.

Για κάθε fold:
1. Το μοντέλο εκπαιδεύεται στο training set.
2. Προβλέπεται η ημερήσια κατά κεφαλήν κατανάλωση στο validation set.
3. Υπολογίζονται δύο κατηγορίες σφαλμάτων:
   - **Σφάλμα σε επίπεδο νοικοκυριού** με τη μετρική MAE.
   - **Σφάλμα στα poverty rates**.

---

## Υπολογισμός Poverty Rates
Τα poverty rates προκύπτουν:
- συγκρίνοντας την προβλεπόμενη κατανάλωση κάθε νοικοκυριού με προκαθορισμένα κατώφλια κατανάλωσης (παρεχόμενα από αρχείο CSV),
- εφαρμόζοντας τα αντίστοιχα βάρη των νοικοκυριών.

Τα προβλεπόμενα poverty rates συγκρίνονται με τα πραγματικά και υπολογίζεται το **Mean Absolute Error (MAE)**.

Η διαδικασία επαναλαμβάνεται για όλα τα folds και στο τέλος υπολογίζεται ο μέσος όρος των μετρικών.

---

## Μοντέλα
Τα μοντέλα που χρησιμοποιήθηκαν είναι:
- Linear Regression
- Random Forest
- XGBoost
- MLP

Για τα μοντέλα με υπερπαραμέτρους (Random Forest, XGBoost, MLP), δοκιμάστηκαν διαφορετικές ρυθμίσεις και επιλέχθηκε εκείνη που ελαχιστοποιεί το σφάλμα στα poverty rates.

---

## Επιλογή και Σύγκριση Αλγορίθμων
Η **Linear Regression** χρησιμοποιήθηκε ως baseline μοντέλο, καθώς εξετάζει γραμμικές σχέσεις και αποτελεί βασικό αλγόριθμο αναφοράς.  
Ωστόσο, σε προβλήματα αυξημένης πολυπλοκότητας αναμένεται περιορισμένη απόδοση.

Τα **Random Forest**, **XGBoost** και **MLP** επιλέχθηκαν επειδή μπορούν να αναπαραστήσουν μη γραμμικές σχέσεις.

Τα αποτελέσματα δείχνουν βελτίωση της απόδοσης όσο αυξάνεται η πολυπλοκότητα του μοντέλου.

---

## Περιορισμοί Μοντέλων
- **Linear Regression**: δεν συλλαμβάνει μη γραμμικές σχέσεις.
- **Random Forest**: μπορεί να υπερπροσαρμοστεί και να μην αποδίδει καλά σε πολύ υψηλές διαστάσεις.
- **XGBoost**: απαιτεί τον μεγαλύτερο χρόνο εκπαίδευσης.
- **MLP**: απαιτεί μεγάλο πλήθος δεδομένων και σωστή κανονικοποίηση.

---

## Πότε τα Μοντέλα Δουλεύουν / Δεν Δουλεύουν Καλά
Τα μοντέλα αποδίδουν καλύτερα όταν:
- υπάρχουν σαφή μοτίβα μεταξύ των χαρακτηριστικών,
- το πλήθος των δεδομένων είναι επαρκές.

Η απόδοση επηρεάζεται αρνητικά από:
- ακραίες τιμές,
- θόρυβο στα δεδομένα,
ιδιαίτερα στα πιο σύνθετα μοντέλα.

---

## Σημαντικότητα Χαρακτηριστικών
Μεγαλύτερη έμφαση δίνεται σε χαρακτηριστικά που σχετίζονται με:
- το εισόδημα,
- τη σύνθεση του νοικοκυριού,
- τις βασικές συνθήκες διαβίωσης,

καθώς επηρεάζουν άμεσα την κατανάλωση και, κατ’ επέκταση, τα poverty rates.

---

## Πιθανές Βελτιώσεις
Η απόδοση θα μπορούσε να βελτιωθεί με:
- προσθήκη περισσότερων ποιοτικών χαρακτηριστικών (π.χ. δημογραφικά, οικονομικοί δείκτες),
- καλύτερο καθαρισμό δεδομένων και μείωση θορύβου,
- περισσότερα δείγματα,
- ενσωμάτωση επιπλέον πληροφορίας σε επίπεδο survey.
